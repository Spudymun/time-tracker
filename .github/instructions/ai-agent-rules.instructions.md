---
applyTo: "**"
---

# AI Agent Behaviour Rules

> Эти правила имеют приоритет над личными предпочтениями агента. Применяются к каждому запросу.

## Язык

Общаться с пользователем ТОЛЬКО на русском языке. Запрещено: украинский, английские предложения.
Исключения: названия переменных/функций в коде, технические термины без русского аналога (API, hook, endpoint), названия библиотек, commit messages.

## Фокус на цели задачи (максимальный приоритет)

Изменять ТОЛЬКО код, который прямо относится к цели задачи.

Запрещено:

- Рефакторинг, оптимизация, улучшения "заодно"
- Удаление "устаревшего" кода вне scope
- Изменение архитектуры сверх необходимого

Красные флаги: слова "заодно", "пока мы здесь", "давайте улучшим", "для консистентности".

Перед каждым изменением: "Это НЕОБХОДИМО для цели задачи?"

## Запрет предположений

Не принимать решений на основе догадок. При малейшей неопределённости — спрашивать пользователя.
Базироваться исключительно на проверенных фактах (прочитанный код, документация, явные требования).

## Исследование перед неочевидным решением

Если решение проблемы неочевидно — ОБЯЗАТЕЛЬНО запустить субагента для исследования вариантов в интернете, прежде чем приступать к реализации.

Признаки неочевидного решения:

- Ошибка незнакома или редко встречается
- Несколько конкурирующих подходов с неясными trade-offs
- Поведение библиотеки/фреймворка не соответствует ожиданиям
- Баг воспроизводится непредсказуемо
- Задача касается интеграции нескольких систем

Последовательность:

1. Признать вслух: «Решение неочевидно, исследую варианты»
2. Запустить субагента с конкретным поисковым запросом (версии библиотек, суть проблемы)
3. Проанализировать результаты, выбрать лучший вариант с обоснованием
4. Предложить план пользователю ПЕРЕД реализацией

## Spec-First подход

Перед реализацией ЛЮБОЙ фичи:

1. Проверить наличие `spec/FEATURE_{name}.md`
2. Прочитать `spec/DOMAIN.md` и `spec/BUSINESS_RULES.md`
3. Если spec отсутствует — сообщить: "Отсутствует spec/FEATURE\_{name}.md. Создай его перед реализацией."
4. Никогда не предполагать бизнес-правила — только из spec

## Структурированный подход

Последовательность для любой нетривиальной задачи:

1. Озвучить понимание задачи
2. Провести анализ существующего кода
3. Предложить план
4. Начать реализацию ТОЛЬКО после одобрения плана

## Запрет избыточности

Перед созданием любого кода — найти существующие решения в проекте.

- Если существующее покрывает 80%+ → переиспользовать
- Если 50–80% → адаптировать
- Только если <50% → создавать новое, максимально обобщённо

## Осознанное удаление

Перед удалением любого файла, функции, зависимости:

1. Прочитать и понять удаляемое ПОЛНОСТЬЮ
2. Найти все места использования
3. Получить явное подтверждение пользователя

Красные флаги: "не знаю зачем это создано", "удаляю для порядка", "никто не использует".

## Полная интеграция

Задача считается выполненной ТОЛЬКО когда:

- Новый код интегрирован в приложение (не просто создан)
- Старый код заменён там где нужно
- Функциональность проверена в runtime
- Исходная проблема решена

"Код написан, компилируется" ≠ "задача выполнена".

## Критическое мышление

Не соглашаться с пользователем автоматически. Давать обоснованную оценку даже если она противоречит запросу.

## Качество кода

Весь предлагаемый код — полностью рабочий:

- Все необходимые импорты включены
- Нет заглушек, TODO, `any` в production коде
- Объяснять ПОЧЕМУ принято решение, а не только ЧТО сделано
