/**
 * ════════════════════════════════════════════════════════════════════════════
 *  Time Tracker — Design System Tokens
 *  Stack: Tailwind CSS v4 (CSS-first) + OKLCH color space
 *
 *  ПРАВИЛО ДЛЯ AI-АГЕНТОВ:
 *  Запрещено использовать raw hex/rgb цвета в className.
 *  Запрещено использовать произвольные Tailwind-классы из дефолтной палитры
 *  (slate-500, gray-300, etc.) — только токены из этого файла.
 *  Все отступы, радиусы, тени — через переменные ниже.
 *  Полные правила: .github/instructions/design-system.instructions.md
 * ════════════════════════════════════════════════════════════════════════════
 */

@import "tailwindcss";

/* ════════════════════════════════════════════════════════════════════════════
   DESIGN TOKENS — @theme (Tailwind v4 CSS-first конфигурация)
   Все переменные автоматически становятся Tailwind utility классами.
   Пример: --color-primary → bg-primary, text-primary, border-primary
   ════════════════════════════════════════════════════════════════════════════ */

@theme {
  /* ── FONTS ──────────────────────────────────────────────────────────────── */
  --font-sans: "Geist", "Inter", ui-sans-serif, system-ui, -apple-system, sans-serif;
  --font-mono: "Geist Mono", "JetBrains Mono", ui-monospace, "Cascadia Code", monospace;
  /* font-mono ОБЯЗАТЕЛЕН для TimerDisplay — цифры не скачут (tabular-nums) */

  /* ── COLORS: PRIMARY (Indigo — доверие + энергия для SaaS) ─────────────── */
  --color-primary: oklch(0.55 0.22 264); /* #5B5BD6 — CTA, активные кнопки */
  --color-primary-hover: oklch(0.48 0.22 264); /* #4B4BBF — hover на primary */
  --color-primary-light: oklch(0.96 0.04 264); /* #EDEDFB — background tint */
  --color-primary-fg: oklch(0.98 0 0); /* #FAFAFA — текст на primary кнопке */

  /* ── COLORS: TIMER (зелёный — активное состояние) ──────────────────────── */
  --color-timer-active: oklch(0.62 0.2 160); /* #16A34A — зелёная точка/dot */
  --color-timer-pulse: oklch(0.75 0.18 160); /* #4ADE80 — pulse ring анимация */
  --color-timer-display: oklch(0.14 0 0); /* совпадает с text-1 по умолчанию */

  /* ── COLORS: SURFACE / BACKGROUND ──────────────────────────────────────── */
  --color-bg: oklch(1 0 0); /* #FFFFFF — страница */
  --color-surface: oklch(0.98 0 0); /* #F9F9FA — карточки, panels */
  --color-surface-2: oklch(0.96 0 0); /* #F4F4F5 — вложенные блоки, hover */
  --color-surface-3: oklch(0.93 0 0); /* #ECECED — активный nav item */

  /* ── COLORS: BORDER ─────────────────────────────────────────────────────── */
  --color-border: oklch(0.91 0 0); /* #E4E4E7 — основная граница */
  --color-border-subtle: oklch(0.95 0 0); /* #F1F1F2 — очень лёгкие разделители */
  --color-border-strong: oklch(0.82 0 0); /* #CACACE — акцентированная граница */

  /* ── COLORS: TEXT ───────────────────────────────────────────────────────── */
  --color-text-1: oklch(0.14 0 0); /* #18181B — основной текст */
  --color-text-2: oklch(0.44 0 0); /* #70707A — вторичный */
  --color-text-3: oklch(0.63 0 0); /* #A1A1AA — muted, placeholder */
  --color-text-disabled: oklch(0.78 0 0); /* #C7C7CC — отключённые элементы */

  /* ── COLORS: SEMANTIC ───────────────────────────────────────────────────── */
  --color-success: oklch(0.64 0.19 160); /* #16A34A — успех */
  --color-success-bg: oklch(0.97 0.04 160); /* #F0FDF4 — фон success-badge */
  --color-success-fg: oklch(0.3 0.12 160); /* тёмный текст на success-bg */

  --color-warning: oklch(0.72 0.16 84); /* #CA8A04 — предупреждение */
  --color-warning-bg: oklch(0.98 0.04 90); /* #FEFCE8 — фон warning */
  --color-warning-fg: oklch(0.38 0.12 84); /* тёмный текст на warning-bg */

  --color-error: oklch(0.62 0.22 27); /* #DC2626 — ошибка, destructive */
  --color-error-bg: oklch(0.97 0.04 27); /* #FEF2F2 — фон error */
  --color-error-fg: oklch(0.34 0.15 27); /* тёмный текст на error-bg */

  --color-info: oklch(0.58 0.18 232); /* #2563EB — информация */
  --color-info-bg: oklch(0.97 0.03 232); /* #EFF6FF — фон info */
  --color-info-fg: oklch(0.3 0.14 232); /* тёмный текст на info-bg */

  /* ── COLORS: PROJECT PALETTE (8 цветов для проектов) ───────────────────── */
  --color-project-indigo: oklch(0.55 0.22 264); /* #5B5BD6 */
  --color-project-blue: oklch(0.58 0.2 232); /* #3B82F6 */
  --color-project-teal: oklch(0.62 0.18 196); /* #14B8A6 */
  --color-project-green: oklch(0.62 0.2 148); /* #22C55E */
  --color-project-orange: oklch(0.72 0.19 50); /* #F97316 */
  --color-project-red: oklch(0.62 0.22 27); /* #EF4444 */
  --color-project-pink: oklch(0.65 0.22 340); /* #EC4899 */
  --color-project-amber: oklch(0.84 0.18 88); /* #EAB308 */
  --color-no-project: oklch(0.7 0 0); /* #A1A1AA — серый для "без проекта" */

  /* ── BORDER RADIUS ───────────────────────────────────────────────────────── */
  --radius-sm: 0.25rem; /*  4px — badges, теги, маленькие элементы */
  --radius-md: 0.5rem; /*  8px — inputs, маленькие карточки */
  --radius-lg: 0.75rem; /* 12px — карточки, panels */
  --radius-xl: 1rem; /* 16px — модальные окна */
  --radius-2xl: 1.5rem; /* 24px — большие panels */
  --radius-full: 9999px; /* pill — кнопки таймера, статус-бейджи */

  /* ── SHADOWS ─────────────────────────────────────────────────────────────── */
  --shadow-sm: 0 1px 2px oklch(0 0 0 / 6%);
  --shadow-md: 0 4px 12px oklch(0 0 0 / 8%);
  --shadow-lg: 0 8px 24px oklch(0 0 0 / 10%);
  --shadow-xl: 0 16px 48px oklch(0 0 0 / 14%);
  --shadow-modal: 0 20px 60px oklch(0 0 0 / 20%);

  /* ── TRANSITIONS ─────────────────────────────────────────────────────────── */
  --duration-instant: 75ms; /* hover color feedback */
  --duration-fast: 150ms; /* кнопки, border, bg */
  --duration-normal: 200ms; /* большинство transitions */
  --duration-slow: 300ms; /* появление panels, modals */
  --duration-slower: 500ms; /* page transitions */

  --ease-default: cubic-bezier(0.4, 0, 0.2, 1); /* material standard */
  --ease-in: cubic-bezier(0.4, 0, 1, 1); /* уходящие элементы */
  --ease-out: cubic-bezier(0, 0, 0.2, 1); /* появляющиеся */
  --ease-spring: cubic-bezier(0.3, 1.4, 0.4, 1); /* bounce (старт таймера) */
}

/* ════════════════════════════════════════════════════════════════════════════
   DARK THEME
   Переключается через класс .dark на <html> (Auth.js совместимо)
   ════════════════════════════════════════════════════════════════════════════ */

.dark {
  --color-bg: oklch(0.09 0 0); /* #111113 */
  --color-surface: oklch(0.13 0 0); /* #1C1C1F */
  --color-surface-2: oklch(0.17 0 0); /* #232326 */
  --color-surface-3: oklch(0.21 0 0); /* #2A2A2E */
  --color-border: oklch(1 0 0 / 12%);
  --color-border-subtle: oklch(1 0 0 / 7%);
  --color-border-strong: oklch(1 0 0 / 20%);
  --color-text-1: oklch(0.97 0 0); /* #F8F8FA */
  --color-text-2: oklch(0.7 0 0); /* #A5A5AD */
  --color-text-3: oklch(0.5 0 0); /* #717179 */
  --color-text-disabled: oklch(0.36 0 0);
  --color-primary: oklch(0.68 0.18 264); /* светлее для dark mode */
  --color-primary-hover: oklch(0.74 0.16 264);
  --color-primary-light: oklch(0.2 0.07 264); /* тёмный tint */
  --color-success-bg: oklch(0.17 0.07 160);
  --color-warning-bg: oklch(0.18 0.06 84);
  --color-error-bg: oklch(0.18 0.07 27);
  --color-info-bg: oklch(0.17 0.06 232);
}

/* ════════════════════════════════════════════════════════════════════════════
   BASE STYLES
   ════════════════════════════════════════════════════════════════════════════ */

@layer base {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    border-color: var(--color-border);
  }

  html {
    /* Отключить мигание при переключении темы */
    color-scheme: light dark;
  }

  body {
    background-color: var(--color-bg);
    color: var(--color-text-1);
    font-family: var(--font-sans);
    font-size: 1rem;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Все интерактивные элементы: focus ring ─────────────── */
  :focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }

  /* Выделение текста ────────────────────────────────────── */
  ::selection {
    background: var(--color-primary-light);
    color: var(--color-primary);
  }

  /* Скроллбар (Chromium) ────────────────────────────────── */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: var(--color-border-strong);
    border-radius: var(--radius-full);
  }
  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-3);
  }
}

/* ════════════════════════════════════════════════════════════════════════════
   UTILITY CLASSES — специфичные для Time Tracker
   ════════════════════════════════════════════════════════════════════════════ */

@layer utilities {
  /* Таймер — всегда моноширинный + tabular-nums (цифры не скачут) */
  .timer-display {
    font-family: var(--font-mono);
    font-variant-numeric: tabular-nums;
    font-feature-settings: "tnum";
    letter-spacing: -0.02em;
  }

  /* Проект без цвета */
  .project-no-color {
    background-color: var(--color-no-project);
  }

  /* Card — стандартный контейнер */
  .card {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
  }

  /* Truncate с гарантированным min-width */
  .text-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
  }
}

/* ════════════════════════════════════════════════════════════════════════════
   АНИМАЦИИ — keyframes
   ════════════════════════════════════════════════════════════════════════════ */

/* Пульсация зелёной точки активного таймера ───────────────────────────────── */
@keyframes timer-pulse-ring {
  0% {
    transform: scale(1);
    opacity: 0.7;
  }
  100% {
    transform: scale(2);
    opacity: 0;
  }
}

/* Появление записи после остановки таймера ────────────────────────────────── */
@keyframes entry-slide-in {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Появление модального окна ───────────────────────────────────────────────── */
@keyframes modal-in {
  from {
    opacity: 0;
    transform: scale(0.96) translateY(8px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Toast slide in ──────────────────────────────────────────────────────────── */
@keyframes toast-in {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Skeleton shimmer ────────────────────────────────────────────────────────── */
@keyframes skeleton-shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* ════════════════════════════════════════════════════════════════════════════
   ANIMATION CLASSES — готовые к использованию
   ════════════════════════════════════════════════════════════════════════════ */

@layer utilities {
  .animate-timer-pulse {
    animation: timer-pulse-ring 1.5s cubic-bezier(0, 0, 0.2, 1) infinite;
  }

  .animate-entry-in {
    animation: entry-slide-in var(--duration-slow) var(--ease-out) both;
  }

  .animate-modal-in {
    animation: modal-in var(--duration-slow) var(--ease-out) both;
  }

  .animate-toast-in {
    animation: toast-in var(--duration-normal) var(--ease-out) both;
  }

  .animate-skeleton {
    background: linear-gradient(
      90deg,
      var(--color-surface-2) 25%,
      var(--color-surface-3) 50%,
      var(--color-surface-2) 75%
    );
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.5s ease-in-out infinite;
  }
}
